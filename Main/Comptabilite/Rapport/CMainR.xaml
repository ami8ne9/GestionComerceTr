<UserControl x:Class="GestionComerce.Main.ProjectManagment.CMainR"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="#F5F7FA">

    <UserControl.Resources>
        <!-- Modern Card Style -->
        <Style x:Key="ModernCardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Padding" Value="24"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#E5E7EB"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" Opacity="0.04" BlurRadius="24" ShadowDepth="0"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Filter Button Style -->
        <Style x:Key="FilterButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#64748B"/>
            <Setter Property="BorderBrush" Value="#E2E8F0"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Height" Value="50"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8"
                                Padding="12">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Top Item Card Style -->
        <Style x:Key="TopItemCardStyle" TargetType="Border">
            <Setter Property="Background" Value="#F8FAFC"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#E2E8F0"/>
        </Style>

        <!-- Rank Badge Style -->
        <Style x:Key="RankBadgeStyle" TargetType="Border">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Background" Value="#EEF2FF"/>
        </Style>

        <!-- Section Header Style -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#1E293B"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Page Title -->
        <TextBlock Grid.Row="0" 
                   Text="Rapports et Statistiques" 
                   FontSize="32" 
                   FontWeight="Bold" 
                   Foreground="#0F172A"
                   Margin="30,30,30,10"/>

        <TextBlock Grid.Row="0"
                   Text="Vue d'ensemble des performances de votre entreprise"
                   FontSize="14"
                   Foreground="#64748B"
                   Margin="30,70,30,20"/>

        <!-- Filter Buttons -->
        <Border Grid.Row="1" 
                Style="{StaticResource ModernCardStyle}"
                Margin="30,0,30,24">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="12"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="12"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="12"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Button x:Name="DayButton" Grid.Column="0" Click="DayButton_Click" Style="{StaticResource FilterButtonStyle}">
                    <StackPanel Orientation="Horizontal">
                        <Path Data="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z" 
                              Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                              Stretch="Uniform" Width="18" Height="18" Margin="0,0,8,0"/>
                        <TextBlock Text="Jour" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Button x:Name="MonthButton" Grid.Column="2" Click="MonthButton_Click" Style="{StaticResource FilterButtonStyle}">
                    <StackPanel Orientation="Horizontal">
                        <Path Data="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z" 
                              Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                              Stretch="Uniform" Width="18" Height="18" Margin="0,0,8,0"/>
                        <TextBlock Text="Mois" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Button x:Name="YearButton" Grid.Column="4" Click="YearButton_Click" Style="{StaticResource FilterButtonStyle}">
                    <StackPanel Orientation="Horizontal">
                        <Path Data="M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z" 
                              Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                              Stretch="Uniform" Width="18" Height="18" Margin="0,0,8,0"/>
                        <TextBlock Text="Année" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Button x:Name="CustomButton" Grid.Column="6" Click="CustomButton_Click" Style="{StaticResource FilterButtonStyle}">
                    <StackPanel Orientation="Horizontal">
                        <Path Data="M11 17c0 .55.45 1 1 1s1-.45 1-1-.45-1-1-1-1 .45-1 1zm0-14v4h2V5.08c3.39.49 6 3.39 6 6.92 0 3.87-3.13 7-7 7s-7-3.13-7-7c0-1.68.59-3.22 1.58-4.42L12 13l1.41-1.41-6.8-6.8v.02C4.42 6.45 3 9.05 3 12c0 4.97 4.02 9 9 9 4.97 0 9-4.03 9-9s-4.03-9-9-9h-1zm7 9c0-.55-.45-1-1-1s-1 .45-1 1 .45 1 1 1 1-.45 1-1zM6 12c0 .55.45 1 1 1s1-.45 1-1-.45-1-1-1-1 .45-1 1z" 
                              Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                              Stretch="Uniform" Width="18" Height="18" Margin="0,0,8,0"/>
                        <TextBlock Text="Personnalisé" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Border>

        <!-- Date Pickers Section -->
        <Border Grid.Row="2" Style="{StaticResource ModernCardStyle}" Margin="30,0,30,24">
            <Grid>
                <!-- Day View -->
                <StackPanel x:Name="DayView" Visibility="Visible">
                    <TextBlock Text="Sélectionner une date" FontSize="13" FontWeight="SemiBold" Foreground="#64748B" Margin="0,0,0,12"/>
                    <DatePicker x:Name="DayDatePicker" Height="48" FontSize="14" SelectedDateChanged="DatePicker_Changed"
                                Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="1.5" Padding="14,12"/>
                </StackPanel>

                <!-- Month View -->
                <StackPanel x:Name="MonthView" Visibility="Collapsed">
                    <TextBlock Text="Sélectionner un mois" FontSize="13" FontWeight="SemiBold" Foreground="#64748B" Margin="0,0,0,12"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="12"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <ComboBox x:Name="MonthComboBox" Grid.Column="0" Height="48" FontSize="14" SelectedIndex="0"
                                  SelectionChanged="DatePicker_Changed" VerticalContentAlignment="Center"
                                  Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="1.5">
                            <ComboBoxItem>Janvier</ComboBoxItem>
                            <ComboBoxItem>Février</ComboBoxItem>
                            <ComboBoxItem>Mars</ComboBoxItem>
                            <ComboBoxItem>Avril</ComboBoxItem>
                            <ComboBoxItem>Mai</ComboBoxItem>
                            <ComboBoxItem>Juin</ComboBoxItem>
                            <ComboBoxItem>Juillet</ComboBoxItem>
                            <ComboBoxItem>Août</ComboBoxItem>
                            <ComboBoxItem>Septembre</ComboBoxItem>
                            <ComboBoxItem>Octobre</ComboBoxItem>
                            <ComboBoxItem>Novembre</ComboBoxItem>
                            <ComboBoxItem>Décembre</ComboBoxItem>
                        </ComboBox>
                        <ComboBox x:Name="MonthYearComboBox" Grid.Column="2" Height="48" FontSize="14"
                                  SelectionChanged="DatePicker_Changed" VerticalContentAlignment="Center"
                                  Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="1.5"/>
                    </Grid>
                </StackPanel>

                <!-- Year View -->
                <StackPanel x:Name="YearView" Visibility="Collapsed">
                    <TextBlock Text="Sélectionner une année" FontSize="13" FontWeight="SemiBold" Foreground="#64748B" Margin="0,0,0,12"/>
                    <ComboBox x:Name="YearComboBox" Height="48" FontSize="14" SelectionChanged="DatePicker_Changed"
                              VerticalContentAlignment="Center" Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="1.5"/>
                </StackPanel>

                <!-- Custom View -->
                <StackPanel x:Name="CustomView" Visibility="Collapsed">
                    <TextBlock Text="Période personnalisée" FontSize="13" FontWeight="SemiBold" Foreground="#64748B" Margin="0,0,0,12"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="24"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="24"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Date de début" FontSize="11" FontWeight="Medium" Foreground="#94A3B8" Margin="0,0,0,8"/>
                            <DatePicker x:Name="StartDatePicker" Height="48" FontSize="14" SelectedDateChanged="DatePicker_Changed1"
                                        Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="1.5" Padding="14,12"/>
                        </StackPanel>
                        <Viewbox Grid.Column="2" Width="20" Height="20" VerticalAlignment="Bottom" Margin="0,0,0,14">
                            <Path Data="M5 12 L19 12 M12 5 L19 12 L12 19" Stroke="#CBD5E1" StrokeThickness="2" Stretch="Uniform"/>
                        </Viewbox>
                        <StackPanel Grid.Column="4">
                            <TextBlock Text="Date de fin" FontSize="11" FontWeight="Medium" Foreground="#94A3B8" Margin="0,0,0,8"/>
                            <DatePicker x:Name="EndDatePicker" Height="48" FontSize="14" SelectedDateChanged="DatePicker_Changed1"
                                        Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="1.5" Padding="14,12"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content Area -->
        <ScrollViewer Grid.Row="3" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="0,0,0,30">

                <!-- KPI Cards Grid -->
                <Grid Margin="30,0,30,24">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Revenue Card -->
                    <Border Grid.Column="0" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <Border Background="#ECFDF5" CornerRadius="8" Width="40" Height="40" HorizontalAlignment="Left" Margin="0,0,0,12">
                                <Path Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z" 
                                      Fill="#10B981" Stretch="Uniform" Width="24" Height="24"/>
                            </Border>
                            <TextBlock Text="Revenu" FontSize="13" Foreground="#64748B" Margin="0,0,0,8" FontWeight="Medium"/>
                            <TextBlock x:Name="RevenueText" Text="0.00 DH" FontSize="28" FontWeight="Bold" Foreground="#10B981" Margin="0,0,0,4"/>
                            <TextBlock Text="Bénéfice total" FontSize="12" Foreground="#94A3B8"/>
                        </StackPanel>
                    </Border>

                    <!-- Bought Card -->
                    <Border Grid.Column="2" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <Border Background="#EFF6FF" CornerRadius="8" Width="40" Height="40" HorizontalAlignment="Left" Margin="0,0,0,12">
                                <Path Data="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z" 
                                      Fill="#3B82F6" Stretch="Uniform" Width="24" Height="24"/>
                            </Border>
                            <TextBlock Text="Acheté" FontSize="13" Foreground="#64748B" Margin="0,0,0,8" FontWeight="Medium"/>
                            <TextBlock x:Name="BoughtText" Text="0.00 DH" FontSize="28" FontWeight="Bold" Foreground="#3B82F6" Margin="0,0,0,4"/>
                            <TextBlock Text="Achats totaux" FontSize="12" Foreground="#94A3B8"/>
                        </StackPanel>
                    </Border>

                    <!-- Sold Card -->
                    <Border Grid.Column="4" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <Border Background="#FEF3C7" CornerRadius="8" Width="40" Height="40" HorizontalAlignment="Left" Margin="0,0,0,12">
                                <Path Data="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z" 
                                      Fill="#F59E0B" Stretch="Uniform" Width="24" Height="24"/>
                            </Border>
                            <TextBlock Text="Vendu" FontSize="13" Foreground="#64748B" Margin="0,0,0,8" FontWeight="Medium"/>
                            <TextBlock x:Name="SoldText" Text="0.00 DH" FontSize="28" FontWeight="Bold" Foreground="#F59E0B" Margin="0,0,0,4"/>
                            <TextBlock Text="Ventes totales" FontSize="12" Foreground="#94A3B8"/>
                        </StackPanel>
                    </Border>

                    <!-- Reverse Card -->
                    <Border Grid.Column="6" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <Border Background="#FCE7F3" CornerRadius="8" Width="40" Height="40" HorizontalAlignment="Left" Margin="0,0,0,12">
                                <Path Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" 
                                      Fill="#EC4899" Stretch="Uniform" Width="24" Height="24"/>
                            </Border>
                            <TextBlock Text="Reverse" FontSize="13" Foreground="#64748B" Margin="0,0,0,8" FontWeight="Medium"/>
                            <TextBlock x:Name="DifferenceText" Text="0.00 DH" FontSize="28" FontWeight="Bold" Foreground="#EC4899" Margin="0,0,0,4"/>
                            <TextBlock Text="Pertes inversées" FontSize="12" Foreground="#94A3B8"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Statistics Grid (Articles & Operations) -->
                <Grid Margin="30,0,30,24">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Border Grid.Column="0" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Articles Vendus" FontSize="13" Foreground="#64748B" Margin="0,0,0,12" FontWeight="Medium"/>
                            <TextBlock x:Name="ArticlesSoldText" Text="0" FontSize="28" FontWeight="Bold" Foreground="#0F172A"/>
                        </StackPanel>
                    </Border>

                    <Border Grid.Column="2" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Articles Achetés" FontSize="13" Foreground="#64748B" Margin="0,0,0,12" FontWeight="Medium"/>
                            <TextBlock x:Name="ArticlesBoughtText" Text="0" FontSize="28" FontWeight="Bold" Foreground="#0F172A"/>
                        </StackPanel>
                    </Border>

                    <Border Grid.Column="4" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Opérations Vente" FontSize="13" Foreground="#64748B" Margin="0,0,0,12" FontWeight="Medium"/>
                            <TextBlock x:Name="SoldOpsText" Text="0" FontSize="28" FontWeight="Bold" Foreground="#0F172A"/>
                        </StackPanel>
                    </Border>

                    <Border Grid.Column="6" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Opérations Achat" FontSize="13" Foreground="#64748B" Margin="0,0,0,12" FontWeight="Medium"/>
                            <TextBlock x:Name="BoughtOpsText" Text="0" FontSize="28" FontWeight="Bold" Foreground="#0F172A"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Top 5 Statistics Section -->
                <Grid Margin="30,0,30,24">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Top 5 Clients -->
                    <Border Grid.Column="0" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                <Border Background="#EEF2FF" CornerRadius="8" Width="36" Height="36" Margin="0,0,12,0">
                                    <Path Data="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" 
                                          Fill="#6366F1" Stretch="Uniform" Width="20" Height="20"/>
                                </Border>
                                <TextBlock Text="Top 5 Clients" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                            </StackPanel>
                            <StackPanel x:Name="TopClientsContainer"/>
                        </StackPanel>
                    </Border>

                    <!-- Top 5 Suppliers -->
                    <Border Grid.Column="2" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                <Border Background="#DBEAFE" CornerRadius="8" Width="36" Height="36" Margin="0,0,12,0">
                                    <Path Data="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z" 
                                          Fill="#3B82F6" Stretch="Uniform" Width="20" Height="20"/>
                                </Border>
                                <TextBlock Text="Top 5 Fournisseurs" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                            </StackPanel>
                            <StackPanel x:Name="TopSuppliersContainer"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Top Articles & Salaries -->
                <Grid Margin="30,0,30,24">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Top 5 Articles -->
                    <Border Grid.Column="0" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                <Border Background="#FEF3C7" CornerRadius="8" Width="36" Height="36" Margin="0,0,12,0">
                                    <Path Data="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" 
                                          Fill="#F59E0B" Stretch="Uniform" Width="20" Height="20"/>
                                </Border>
                                <TextBlock Text="Top 5 Articles" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                            </StackPanel>
                            <StackPanel x:Name="TopArticlesContainer"/>
                        </StackPanel>
                    </Border>

                    <!-- Top 5 Salaries -->
                    <Border Grid.Column="2" Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                <Border Background="#DCFCE7" CornerRadius="8" Width="36" Height="36" Margin="0,0,12,0">
                                    <Path Data="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z" 
                                          Fill="#22C55E" Stretch="Uniform" Width="20" Height="20"/>
                                </Border>
                                <TextBlock Text="Top 5 Salaires" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                            </StackPanel>
                            <StackPanel x:Name="TopSalariesContainer"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Operations List Section -->
                <Border Style="{StaticResource ModernCardStyle}" Margin="30,0,30,24">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                            <Border Background="#F3E8FF" CornerRadius="8" Width="36" Height="36" Margin="0,0,12,0">
                                <Path Data="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" 
                                      Fill="#A855F7" Stretch="Uniform" Width="20" Height="20"/>
                            </Border>
                            <TextBlock Text="Liste des Opérations" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                        </StackPanel>
                        <ScrollViewer MaxHeight="400" VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <StackPanel x:Name="RevenueOperationsContainer"/>

                                <Border Height="27" Margin="0,12,0,0" Name="SeeMoreContainer2" Visibility="Collapsed">
                                    <Button HorizontalAlignment="Center" VerticalAlignment="Top"
                                            Background="Transparent" BorderThickness="0" Cursor="Hand"
                                            Padding="12,6" Click="Button2_Click" Height="30">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border Background="{TemplateBinding Background}" 
                                                                    Padding="{TemplateBinding Padding}">
                                                                <ContentPresenter HorizontalAlignment="Center" 
                                                                                VerticalAlignment="Center"/>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Foreground" Value="#2563EB"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                        <TextBlock Text="Voir Plus" Foreground="#3B82F6" 
                                                   FontSize="14" FontWeight="Medium"/>
                                    </Button>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </StackPanel>
                </Border>

                <!-- Articles List Section -->
                <Border Style="{StaticResource ModernCardStyle}" Margin="30,0,30,0">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                            <Border Background="#FEF3C7" CornerRadius="8" Width="36" Height="36" Margin="0,0,12,0">
                                <Path Data="M20 2H4c-1 0-2 .9-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1.1-1-2-2-2zm-5 12H9v-2h6v2zm5-7H4V4h16v3z" 
                                      Fill="#F59E0B" Stretch="Uniform" Width="20" Height="20"/>
                            </Border>
                            <TextBlock Text="Liste des Articles (Mouvements)" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                        </StackPanel>
                        <ScrollViewer MaxHeight="400" VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <StackPanel x:Name="RevenueArticlesContainer"/>

                                <Border Height="27" Margin="0,12,0,0" Name="SeeMoreContainer3" Visibility="Collapsed">
                                    <Button HorizontalAlignment="Center" VerticalAlignment="Top"
                                            Background="Transparent" BorderThickness="0" Cursor="Hand"
                                            Padding="12,6" Click="Button3_Click" Height="30">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border Background="{TemplateBinding Background}" 
                                                                    Padding="{TemplateBinding Padding}">
                                                                <ContentPresenter HorizontalAlignment="Center" 
                                                                                VerticalAlignment="Center"/>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Foreground" Value="#2563EB"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                        <TextBlock Text="Voir Plus" Foreground="#3B82F6" 
                                                   FontSize="14" FontWeight="Medium"/>
                                    </Button>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>