<Window x:Class="GestionComerce.Main.Facturation.CreateFacture.WEditArticle"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:resx="clr-namespace:GestionComerce.Resources"
        Title="{x:Static resx:Resources.ModifyArticle}" 
        Height="580" 
        Width="500"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Background="#F8FAFC">

    <Window.Resources>
        <SolidColorBrush x:Key="PrimaryBrush"      Color="#3B82F6"/>
        <SolidColorBrush x:Key="SuccessBrush"       Color="#10B981"/>
        <SolidColorBrush x:Key="SurfaceBrush"       Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BorderBrush"        Color="#E2E8F0"/>
        <SolidColorBrush x:Key="TextPrimaryBrush"   Color="#0F172A"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#64748B"/>

        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="FontFamily"      Value="Segoe UI"/>
            <Setter Property="FontSize"        Value="14"/>
            <Setter Property="FontWeight"      Value="SemiBold"/>
            <Setter Property="Padding"         Value="24,12"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor"          Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bd"
                                Background="{TemplateBinding Background}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Opacity" Value="0.88"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="bd" Property="Opacity" Value="0.75"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--
            FIX: Use literal Margin="10,0" on PART_ContentHost instead of
            TemplateBinding Padding — the binding collapses the content area
            and makes typed text invisible.
        -->
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="FontFamily"               Value="Segoe UI"/>
            <Setter Property="FontSize"                 Value="14"/>
            <Setter Property="Background"               Value="#FFFFFF"/>
            <Setter Property="BorderBrush"              Value="#E2E8F0"/>
            <Setter Property="BorderThickness"          Value="1.5"/>
            <Setter Property="Foreground"               Value="#0F172A"/>
            <Setter Property="CaretBrush"               Value="#0F172A"/>
            <Setter Property="SelectionBrush"           Value="#BFDBFE"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="bd"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ScrollViewer x:Name="PART_ContentHost"
                                          Margin="14,0"
                                          Focusable="False"
                                          HorizontalScrollBarVisibility="Hidden"
                                          VerticalScrollBarVisibility="Hidden"
                                          VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="bd" Property="BorderBrush"     Value="#3B82F6"/>
                                <Setter TargetName="bd" Property="BorderThickness" Value="2"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#F8FAFC"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="bd" Property="Background" Value="#F1F5F9"/>
                                <Setter Property="Foreground" Value="#94A3B8"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize"   Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#64748B"/>
            <Setter Property="Margin"     Value="0,0,0,8"/>
        </Style>
    </Window.Resources>

    <Grid Margin="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,24">
            <TextBlock Text="{x:Static resx:Resources.ModifyArticle}"
                       FontSize="24" FontWeight="Bold"
                       Foreground="#0F172A"/>

            <!-- Article name + type badge side by side -->
            <StackPanel Orientation="Horizontal" Margin="0,6,0,0" VerticalAlignment="Center">
                <TextBlock x:Name="txtArticleNameLabel"
                           Text="Nom de l'article"
                           FontSize="14" Foreground="#64748B"
                           VerticalAlignment="Center"/>
                <Border x:Name="badgeType"
                        Background="#EDE9FE" CornerRadius="4"
                        Padding="8,3" Margin="10,0,0,0"
                        VerticalAlignment="Center">
                    <TextBlock x:Name="txtBadgeType"
                               Text="Stock"
                               FontFamily="Segoe UI" FontSize="11" FontWeight="SemiBold"
                               Foreground="#6D28D9"/>
                </Border>
            </StackPanel>
        </StackPanel>

        <!-- Fields -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>

                <!-- Article name — always editable.
                     If the user changes this on a stock article it becomes "Personnalisé". -->
                <StackPanel Margin="0,0,0,20">
                    <TextBlock Text="Nom de l'article" Style="{StaticResource FieldLabel}"/>
                    <TextBox x:Name="txtArticleName"
                             Style="{StaticResource ModernTextBox}"
                             Height="46"
                             TextChanged="txtArticleName_TextChanged"/>
                </StackPanel>

                <StackPanel Margin="0,0,0,20">
                    <TextBlock Text="{x:Static resx:Resources.UnitPrice}"
                               Style="{StaticResource FieldLabel}"/>
                    <TextBox x:Name="txtPrice"
                             Style="{StaticResource ModernTextBox}"
                             Height="46"
                             PreviewTextInput="DecimalTextBox_PreviewTextInput"/>
                </StackPanel>

                <StackPanel Margin="0,0,0,20">
                    <TextBlock Text="{x:Static resx:Resources.Quantity}"
                               Style="{StaticResource FieldLabel}"/>
                    <TextBox x:Name="txtQuantity"
                             Style="{StaticResource ModernTextBox}"
                             Height="46"
                             PreviewTextInput="DecimalTextBox_PreviewTextInput"/>
                </StackPanel>

                <StackPanel Margin="0,0,0,20">
                    <TextBlock Text="{x:Static resx:Resources.TVA}"
                               Style="{StaticResource FieldLabel}"/>
                    <TextBox x:Name="txtTVA"
                             Style="{StaticResource ModernTextBox}"
                             Height="46"
                             PreviewTextInput="DecimalTextBox_PreviewTextInput"/>
                </StackPanel>

                <StackPanel x:Name="ExpeditionPanel" Margin="0,0,0,20" Visibility="Collapsed">
                    <TextBlock Text="{x:Static resx:Resources.ShippedQuantity}"
                               Style="{StaticResource FieldLabel}"/>
                    <TextBox x:Name="txtExpedition"
                             Style="{StaticResource ModernTextBox}"
                             Height="46"
                             PreviewTextInput="DecimalTextBox_PreviewTextInput"/>
                </StackPanel>

            </StackPanel>
        </ScrollViewer>

        <!-- Footer buttons -->
        <Grid Grid.Row="2" Margin="0,24,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="16"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0"
                    Content="{x:Static resx:Resources.Cancel}"
                    Style="{StaticResource ModernButtonStyle}"
                    Background="#94A3B8" Foreground="White"
                    Height="45"
                    Click="btnCancel_Click"/>

            <Button Grid.Column="2"
                    Content="{x:Static resx:Resources.Save}"
                    Style="{StaticResource ModernButtonStyle}"
                    Background="{StaticResource SuccessBrush}" Foreground="White"
                    Height="45"
                    Click="btnSave_Click"/>
        </Grid>
    </Grid>
</Window>
